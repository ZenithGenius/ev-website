/*! For license information please see 7441.min.js.LICENSE.txt */
(this.webpackChunk_tsparticles_all=this.webpackChunk_tsparticles_all||[]).push([[7441],{7441:(t,i,n)=>{n.d(i,{PolygonMaskInstance:()=>l});var e=n(3624);const s=`${e.gK} No polygon data loaded.`,a=`${e.gK} No polygon found, you need to specify SVG url in config.`,o=0,h=0,r=.5;class l{constructor(t,i){this._checkInsidePolygon=t=>{const i=this._container,n=i.actualOptions.polygon;if(!n?.enable||"none"===n.type||"inline"===n.type)return!0;if(!this.raw)throw new Error(a);const s=i.canvas.size,o=t?.x??(0,e.sZ)()*s.width,h=t?.y??(0,e.sZ)()*s.height;let r=!1;for(let t=0,i=this.raw.length-1;t<this.raw.length;i=t++){const n=this.raw[t],e=this.raw[i];n.y>h!=e.y>h&&o<(e.x-n.x)*(h-n.y)/(e.y-n.y)+n.x&&(r=!r)}return"inside"===n.type?r:"outside"===n.type&&!r},this._createPath2D=()=>{if(this._container.actualOptions.polygon&&this.paths?.length)for(const t of this.paths){const i=t.element?.getAttribute("d");if(i){const n=new Path2D(i),e=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),s=new Path2D,a=e.scale(this._scale);s.addPath?(s.addPath(n,a),t.path2d=s):delete t.path2d}else delete t.path2d;if(t.path2d??!this.raw)continue;t.path2d=new Path2D;const n=0,e=this.raw[n];t.path2d.moveTo(e.x,e.y),this.raw.forEach(((i,e)=>{e>n&&t.path2d?.lineTo(i.x,i.y)})),t.path2d.closePath()}},this._downloadSvgPath=async(t,i)=>{const n=this._container.actualOptions.polygon;if(!n)return;const s=t??n.url,a=i??!1;if(!s||void 0!==this.paths&&!a)return this.raw;const o=await fetch(s);if(!o.ok)throw new Error(`${e.gK} occurred during polygon mask download`);return await this._parseSvgPath(await o.text(),i)},this._drawPoints=()=>{if(this.raw)for(const t of this.raw)this._container.particles.addParticle({x:t.x,y:t.y})},this._getEquidistantPointByIndex=t=>{const i=this._container.actualOptions;if(!i.polygon)return;if(!this.raw?.length||!this.paths?.length)throw new Error(s);let n,e=0;const a=this.paths.reduce(((t,i)=>t+i.length),0)/i.particles.number.value;for(const i of this.paths){const s=a*t-e;if(s<=i.length){n=i.element.getPointAtLength(s);break}e+=i.length}const r=this._scale;return{x:(n?.x??o)*r+(this.offset?.x??o),y:(n?.y??h)*r+(this.offset?.y??h)}},this._getPointByIndex=t=>{if(!this.raw?.length)throw new Error(s);const i=this.raw[t%this.raw.length];return{x:i.x,y:i.y}},this._getRandomPoint=()=>{if(!this.raw?.length)throw new Error(s);const t=(0,e.c8)(this.raw);return{x:t.x,y:t.y}},this._getRandomPointByLength=()=>{if(!this._container.actualOptions.polygon)return;if(!this.raw?.length||!this.paths?.length)throw new Error(s);const t=(0,e.c8)(this.paths),i=Math.floor((0,e.sZ)()*t.length)+1,n=t.element.getPointAtLength(i),a=this._scale;return{x:n.x*a+(this.offset?.x??o),y:n.y*a+(this.offset?.y??h)}},this._initRawData=async t=>{const i=this._container.actualOptions.polygon;if(i){if(i.url)this.raw=await this._downloadSvgPath(i.url,t);else if(i.data){const n=i.data;let s;if((0,e.HD)(n))s=n;else{const t=t=>`<path d="${t}" />`,i=(0,e.kJ)(n.path)?n.path.map(t).join(""):t(n.path);s=`<svg ${'xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'} width="${n.size.width}" height="${n.size.height}">${i}</svg>`}this.raw=await this._parseSvgPath(s,t)}this._createPath2D(),this._engine.dispatchEvent("polygonMaskLoaded",{container:this._container})}},this._parseSvgPath=async(t,i)=>{const s=i??!1;if(void 0!==this.paths&&!s)return this.raw;const a=this._container,o=a.actualOptions.polygon;if(!o)return;const h=(new DOMParser).parseFromString(t,"image/svg+xml"),l=h.getElementsByTagName("svg")[0];let c=l.getElementsByTagName("path");c.length||(c=h.getElementsByTagName("path")),this.paths=[];for(let t=0;t<c.length;t++){const i=c.item(t);i&&this.paths.push({element:i,length:i.getTotalLength()})}const p=this._scale;this.dimension.width=parseFloat(l.getAttribute("width")??"0")*p,this.dimension.height=parseFloat(l.getAttribute("height")??"0")*p;const g=o.position??{x:50,y:50},d=a.canvas.size;this.offset={x:d.width*g.x/e.tZ-this.dimension.width*r,y:d.height*g.y/e.tZ-this.dimension.height*r};const{parsePaths:w}=await n.e(2899).then(n.bind(n,2899));return w(this.paths,p,this.offset)},this._polygonBounce=async(t,i,s)=>{const a=this._container.actualOptions.polygon;if(!this.raw||!a?.enable||"top"!==s)return!1;if("inside"===a.type||"outside"===a.type){let i,s,a;const o=t.getPosition(),h=t.getRadius(),r=1;for(let l=0,c=this.raw.length-r;l<this.raw.length;c=l++){const r=this.raw[l],p=this.raw[c],{calcClosestPointOnSegment:g}=await n.e(2899).then(n.bind(n,2899));i=g(r,p,o);const d=(0,e.oW)(o,i);if([s,a]=[d.dx,d.dy],d.distance<h){const{segmentBounce:i}=await n.e(2899).then(n.bind(n,2899));return i(r,p,t.velocity),!0}}if(i&&void 0!==s&&void 0!==a&&!this._checkInsidePolygon(o)){const n={x:1,y:1},e=2*h,s=-1;return o.x>=i.x&&(n.x=-1),o.y>=i.y&&(n.y=-1),t.position.x=i.x+e*n.x,t.position.y=i.y+e*n.y,t.velocity.mult(s),!0}}else if("inline"===a.type&&t.initialPosition){const i=(0,e.Sp)(t.initialPosition,t.getPosition()),{velocity:n}=t;if(i>this._moveRadius)return n.x=n.y*r-n.x,n.y=n.x*r-n.y,!0}return!1},this._randomPoint=()=>{const t=this._container,i=t.actualOptions.polygon;if(!i)return;let n;if("inline"===i.type)switch(i.inline.arrangement){case"random-point":n=this._getRandomPoint();break;case"random-length":n=this._getRandomPointByLength();break;case"equidistant":n=this._getEquidistantPointByIndex(t.particles.count);break;default:n=this._getPointByIndex(t.particles.count)}else{const i=t.canvas.size;n={x:(0,e.sZ)()*i.width,y:(0,e.sZ)()*i.height}}return this._checkInsidePolygon(n)?n:this._randomPoint()},this._container=t,this._engine=i,this.dimension={height:0,width:0},this._moveRadius=0,this._scale=1}clickPositionValid(t){const i=this._container.actualOptions.polygon;return!!i?.enable&&"none"!==i.type&&"inline"!==i.type&&this._checkInsidePolygon(t)}async draw(t){if(!this.paths?.length)return;const i=this._container.actualOptions.polygon;if(!i?.enable)return;const e=i.draw;if(!e.enable)return;const s=this.raw;for(const i of this.paths){const a=i.path2d;if(t)if(a&&this.offset){const{drawPolygonMaskPath:i}=await n.e(2899).then(n.bind(n,2899));i(t,a,e.stroke,this.offset)}else if(s){const{drawPolygonMask:i}=await n.e(2899).then(n.bind(n,2899));i(t,s,e.stroke)}}}async init(){const t=this._container,i=t.actualOptions.polygon,n=t.retina.pixelRatio;i&&(this._moveRadius=i.move.radius*n,this._scale=i.scale*n,i.enable&&await this._initRawData())}async particleBounce(t,i,n){return await this._polygonBounce(t,i,n)}particlePosition(t){const i=this._container.actualOptions.polygon;if(i?.enable&&(this.raw?.length??0)>0)return(0,e.ZB)({},t||this._randomPoint())}particlesInitialization(){const t=this._container.actualOptions.polygon;return!(!t?.enable||"inline"!==t.type||"one-per-point"!==t.inline.arrangement&&"per-point"!==t.inline.arrangement)&&(this._drawPoints(),!0)}resize(){const t=this._container,i=t.actualOptions.polygon;if(!i?.enable||"none"===i.type)return;this.redrawTimeout&&clearTimeout(this.redrawTimeout);this.redrawTimeout=window.setTimeout((()=>{(async()=>{await this._initRawData(!0),await t.particles.redraw()})()}),250)}stop(){delete this.raw,delete this.paths}}}}]);